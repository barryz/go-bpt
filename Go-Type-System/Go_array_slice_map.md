> 译自： [Arrays, Slice And Maps in Go](https://go101.org/article/container.html)


# Go中的数组、切片和Map

严格来说， Go中有三种一等公民的容器类型。 它们分别是数组、切片和Map。某些时候， 字符串和channel也被当作容器类型， 但是这篇文章不会涉及这两种类型。 本篇文章提到的容器类型只会是上述列举的三种。

关于这三种容器类型有很多细节， 本文将一一列举。

## 容器类型和值的简单预览

这三种类型的每个值用于存储元素值的集合。 存储在容器值内的所有元素的类型是相同的。 这些相同的类型被称作该容器值的元素类型。

容器中的每个元素都有一个关联的键。每个元素值都可以通过其关联的键来访问。Map类型的key类型必须是[可比较类型](https://go101.org/article/type-system-overview.html#types-not-support-comparison)。 数组和切片的key类型是内建类型`int`。数组和切片元素的key是非负整数， 其标记了这些元素在数组或切片中的位置。这些非负整数的key通常被称为索引。


 每个容器的值都有一个长度（length）用来表示当前的容器存了多少个元素。 数组和切片值的非负整数key的有效范围是从零（包括）到数组或切片的长度值（不包括该值）。 对于Map类型的每一个值，Map值的键值可以是该Map类型的键类型的任意值。

 这三种容器类型之间又有很多的不同点。主要的差异体现在这三种容器类型的内存布局上。从上一篇文章[Value parts](https://go101.org/article/value-part.html)中，我们了解到一个数组值只由一个直接部分组成，但是一个切片或Map值可能会有一个底层部分，这部分是由切片或Map值的直接部分所引用的。

数组和切片的元素都是连续地存储在一个连续内存段中。对于一个数组来说，连续的内存段就是该数组的直接部分。 对于一个切片来说，连续的内存段则存储着该切片的底层部分。 标准Go编译器/运行时实现的Map采用的是HashTable算法。 所以一个Map的所有的元素也是存储在一个底层的连续的内存段中， 但是他们可能不是连续的。这这些连续的内存段中可能会存在很多的间隙（Gap）。

另一种常见的Map实现算法是二叉树算法， 但是下文的描述假设所有的Map底层结构都是HashTable的实现。无论使用何种算法， 与Map元素相关联的Key也同样存储在Map中。


我们可以通过key来访问一个元素。 所有容器类型的元素访问的时间复杂度都是`O(1)`，但是， 通常Map元素访问的速度要比切片和数组元素访问的时间慢上几倍。


注意的是，当值被复制时，值的底层部分不会被复制。换句话说， 如果一个值有底层部分， 那么该值的拷贝将会与其共享底层部分。这也是数组和切片/Map之间许多行为差异的根本原因， 下面的文章将会介绍这些差异行为。
